# Vectors Enhanced 项目简介

## 项目概述
Vectors Enhanced 是 SillyTavern 的第三方扩展插件，提供了先进的向量化和语义搜索功能。该插件允许用户对聊天历史、文件和世界信息进行向量化处理，并在对话中动态注入相关内容。

## 当前状态
项目已经拥有完整的功能实现，但代码架构存在严重的耦合问题。主文件 `index.js` 超过5000行，集成了UI、业务逻辑、数据处理和API调用等多个职责。

## 核心功能
1. **内容向量化**
   - 支持聊天消息、文件、世界信息的向量化
   - 多种向量化引擎：Transformers.js（本地）、Ollama、vLLM、WebLLM
   - 支持批量处理和增量更新

2. **向量管理**
   - 向量数据的存储、查询和删除
   - 向量数据库的导入/导出
   - 向量去重和版本管理

3. **智能注入**
   - 基于语义相似度的内容检索
   - 灵活的注入位置配置
   - 支持标签提取和标签触发的内容注入

4. **任务管理**
   - 异步任务队列
   - 并发控制
   - 任务进度跟踪和状态显示

## 技术栈
- **前端框架**: jQuery + 原生JavaScript
- **UI**: HTML + CSS (无UI框架)
- **向量化引擎**: 
  - Transformers.js (本地BERT模型)
  - Ollama API
  - vLLM API
  - WebLLM (浏览器内LLM)
- **存储**: 浏览器本地存储 (IndexedDB/LocalStorage)
- **构建工具**: 无 (原生JavaScript)

## 重构目标
1. **架构优化**
   - 从单体架构迁移到分层+插件式架构
   - 实现高内聚、低耦合的模块化设计
   - 建立清晰的职责边界

2. **代码质量提升**
   - 消除代码冗余
   - 提高可维护性和可扩展性
   - 降低圈复杂度

3. **功能增强**
   - 添加LLM内容总结功能
   - 支持外部任务挂载
   - 改进用户界面和交互体验

4. **性能优化**
   - 实现更高效的任务调度
   - 优化大文本处理
   - 添加智能缓存机制

## 重构策略
采用渐进式重构方法，确保每一步都可独立验证，保持功能完整性和向后兼容性。整个重构过程分为10个阶段，从基础架构搭建到最终的清理优化，预计需要2-3周时间完成。

## 项目价值
- 为SillyTavern用户提供强大的语义搜索和内容管理能力
- 通过向量化技术增强AI对话的上下文相关性
- 支持多种向量化引擎，适应不同用户的需求和环境
